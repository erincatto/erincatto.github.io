<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Box2D: Foundations</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
window.MathJax = {
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.svg"/></td>
  <td id="projectalign">
   <div id="projectname">Box2D<span id="projectnumber">&#160;3.0.0</span>
   </div>
   <div id="projectbrief">A 2D physics engine</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('md_foundation.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Foundations</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md26"></a>Box2D provides minimal base functionality for allocation hooks and vector math. The C interface allows most runtime data and types to be defined internally in the <code>src</code> folder.</p>
<h1><a class="anchor" id="autotoc_md27"></a>
Assertions</h1>
<p>Box2D will assert on bad input. This includes things like sending in NaN or infinity for values. It will assert if you use negative values for things that should only be positive, such as density.</p>
<p>Box2D will also assert if an internal bug is detected. For this reason, it is advisable to build Box2D from source. The Box2D library compiles in about a second on my computer.</p>
<p>You may wish to capture assertions in your application. In this case you can use <code><a class="el" href="group__base.html#gaa1a866c5d7a43cab3353cd762dc22f1b" title="Override the default assert callback.">b2SetAssertFcn()</a></code>. This allows you to override the debugger break and/or perform your own error handling.</p>
<h1><a class="anchor" id="autotoc_md28"></a>
Allocation</h1>
<p>Box2D uses memory efficiently and minimizes per frame allocations by pooling memory. The engine quickly adapts to the simulation size. After the first step or two of simulation, there should be no further per frame allocations.</p>
<p>As bodies, shapes, and joints are created and destroyed, their memory will be recycled. Internally all this data is stored in contiguous arrays. When an object is destroyed, the array element will be marked as empty. And when an object is created it will use empty slots in the array using an efficient free list.</p>
<p>Once the internal memory pools are initially filled, the only allocations should be for sleeping islands since their data is copied out of the main simulation. Generally, these allocations should be infrequent.</p>
<p>You can provide a custom allocator using <code><a class="el" href="group__base.html#ga61cd3cba135821c54537871ab731ca92" title="This allows the user to override the allocation functions.">b2SetAllocator()</a></code> and you can get the number of bytes allocated using <code><a class="el" href="group__base.html#gaedd3d7b8951726dcd6a6733d6785df4a">b2GetByteCount()</a></code>.</p>
<h1><a class="anchor" id="autotoc_md29"></a>
Version</h1>
<p>The <a class="el" href="group__base.html#structb2_version" title="Version numbering scheme.">b2Version</a> structure holds the current version so you can query this at run-time using <code><a class="el" href="group__base.html#gaf28c62fb4c067a759fb9a0a79e650fda" title="Get the current version of Box2D.">b2GetVersion()</a></code>.</p>
<div class="fragment"><div class="line"><a class="code hl_struct" href="group__base.html#structb2_version">b2Version</a> version = <a class="code hl_function" href="group__base.html#gaf28c62fb4c067a759fb9a0a79e650fda">b2GetVersion</a>();</div>
<div class="line">printf(<span class="stringliteral">&quot;Box2D version %d.%d.%d\n&quot;</span>, version.<a class="code hl_variable" href="group__base.html#aec0151dab0b5f4ca7c621a00f040adb9">major</a>, version.<a class="code hl_variable" href="group__base.html#a01eb6e0f78d658d53400340ff281ff92">minor</a>, version.patch);</div>
<div class="ttc" id="agroup__base_html_a01eb6e0f78d658d53400340ff281ff92"><div class="ttname"><a href="group__base.html#a01eb6e0f78d658d53400340ff281ff92">b2Version::minor</a></div><div class="ttdeci">int minor</div><div class="ttdoc">Incremental changes.</div><div class="ttdef"><b>Definition</b> base.h:76</div></div>
<div class="ttc" id="agroup__base_html_aec0151dab0b5f4ca7c621a00f040adb9"><div class="ttname"><a href="group__base.html#aec0151dab0b5f4ca7c621a00f040adb9">b2Version::major</a></div><div class="ttdeci">int major</div><div class="ttdoc">Significant changes.</div><div class="ttdef"><b>Definition</b> base.h:73</div></div>
<div class="ttc" id="agroup__base_html_gaf28c62fb4c067a759fb9a0a79e650fda"><div class="ttname"><a href="group__base.html#gaf28c62fb4c067a759fb9a0a79e650fda">b2GetVersion</a></div><div class="ttdeci">b2Version b2GetVersion(void)</div><div class="ttdoc">Get the current version of Box2D.</div></div>
<div class="ttc" id="agroup__base_html_structb2_version"><div class="ttname"><a href="group__base.html#structb2_version">b2Version</a></div><div class="ttdoc">Version numbering scheme.</div><div class="ttdef"><b>Definition</b> base.h:71</div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md30"></a>
Vector Math</h1>
<p>Box2D includes a small vector math library including types <code><a class="el" href="group__math.html#structb2_vec2" title="2D vector This can be used to represent a point or free vector">b2Vec2</a></code>, <code><a class="el" href="group__math.html#structb2_rot" title="2D rotation This is similar to using a complex number for rotation">b2Rot</a></code>, <code><a class="el" href="group__math.html#structb2_transform" title="A 2D rigid transform.">b2Transform</a></code>, and <code><a class="el" href="group__math.html#structb2_a_a_b_b" title="Axis-aligned bounding box.">b2AABB</a></code>. This has been designed to suit the internal needs of Box2D and the interface. All the members are exposed, so you may use them freely in your application.</p>
<p>The math library is kept simple to make Box2D easy to port and maintain.</p>
<h1><a class="anchor" id="multi"></a>
Multithreading</h1>
<p>Box2D has been highly optimized for multithreading. Multithreading is not required and by default Box2D will run single-threaded. If performance is important for your application, you should consider using the multithreading interface.</p>
<p>Box2D multithreading has been designed to work with your application's task system. Box2D does not create threads. The Samples application shows how to do this using the open source tasks system <a href="https://github.com/dougbinks/enkiTS">enkiTS</a>.</p>
<p>Multithreading is established for each Box2D world you create and must be hooked up to the world definition. See <code><a class="el" href="group__world.html#ga2e71ae8fa38cb62acdd21b5715630f6e" title="Task interface This is prototype for a Box2D task.">b2TaskCallback()</a></code>, <code><a class="el" href="group__world.html#gabe25f2bb74325a128203d7c009d81157" title="These functions can be provided to Box2D to invoke a task system.">b2EnqueueTaskCallback()</a></code>, and <code><a class="el" href="group__world.html#gaf6f6e1bb503bb0bd7a7fc1552ef7236a" title="Finishes a user task object that wraps a Box2D task.">b2FinishTaskCallback()</a></code> for more details. Also see <code><a class="el" href="group__world.html#ac909817764b448495d5178da27342709" title="Number of workers to use with the provided task system.">b2WorldDef::workerCount</a></code>, <code><a class="el" href="group__world.html#aee2d25f33f224008eae4825353757137" title="Function to spawn tasks.">b2WorldDef::enqueueTask</a></code>, and <code><a class="el" href="group__world.html#a7f1b41bc118d3d34d9d76f09523129d1" title="Function to finish a task.">b2WorldDef::finishTask</a></code>.</p>
<p>The multithreading design for Box2D is focused on <a href="https://en.wikipedia.org/wiki/Data_parallelism">data parallelism</a>. The idea is to use multiple cores to complete the world simulation as fast as possible. Box2D multithreading is not designed for <a href="https://en.wikipedia.org/wiki/Task_parallelism">task parallelism</a>. Often in games you may have a render thread and an audio thread that do work in isolation from the main thread. Those are examples of task parallelism.</p>
<p>So when you design your game loop, you should let Box2D <em>go wide</em> and use multiple cores to finish its work quickly, without other threads trying to interact with the Box2D world.</p>
<blockquote class="doxtable">
<p>&zwj;<b>Caution</b>: While Box2D is designed for multithreading, its interface is <em>not</em> thread-safe. Modifying the Box2D world during simulation or from multiple threads will result in a <a href="https://en.wikipedia.org/wiki/Race_condition">race condition</a>. </p>
</blockquote>
<p>It <em>is safe</em> to do ray-casts, shape-casts, and overlap tests from multiple threads outside of <code><a class="el" href="group__world.html#ga0249cf75273319ca548d55734d7297c4" title="Simulate a world for one time step.">b2World_Step()</a></code>. Generally, any read-only operation is safe to do multithreaded outside of <code><a class="el" href="group__world.html#ga0249cf75273319ca548d55734d7297c4" title="Simulate a world for one time step.">b2World_Step()</a></code>. This can be very useful if you have multithreaded game logic. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
